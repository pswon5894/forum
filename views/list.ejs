<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="/main.css" rel ="stylesheet">
</head>
<body class="grey-bg">

    <%- include('nav.ejs') %>
    <!-- ui ì¬ì‚¬ìš© -->

    <input class="search">
    <button class="search-send">ê²€ìƒ‰</button>

    <script>
        document.querySelector('.search-send').addEventListener('click', function(){
            let ì…ë ¥í•œê±° = document.querySelector('.search').value
            location.href ='/search?val=' + ì…ë ¥í•œê±°
            // ì¿¼ë¦¬ìŠ¤íŠ¸ë§
        })
    </script>

    <!-- <%= JSON.stringify(ê¸€ëª©ë¡) %> -->
<div class="white-bg">
    <% for ( let i =0; i < ê¸€ëª©ë¡.length; i++) { %>
    <div class="list-box">
    <h4>
        <a href="/detail/<%= ê¸€ëª©ë¡[i]._id %>"><%= ê¸€ëª©ë¡[i].title %></a>
        <a href="/edit/<%= ê¸€ëª©ë¡[i]._id %>">âœï¸</a>
        <span class="delete" data-id="<%= ê¸€ëª©ë¡[i]._id %>">ğŸ—‘ï¸</span>
        <!-- ì‚­ì œëŠ” ajaxë¡œ êµ¬ì„±, ìˆ˜ì •ë²„íŠ¼ ì²˜ëŸ¼ êµ¬ì„±í•´ë„ ë˜ê¸´í•¨ -->
    </h4>    <!-- ì„œë²„ì‚¬ì´ë“œ ë Œë”ë§ -->
    <p>ê¸€ë‚´ìš©ì„</p>
  </div>
    <% } %>
</div>

<a href="/list/next/<%= ê¸€ëª©ë¡[ê¸€ëª©ë¡.length - 1].id %>">ë‹¤ìŒ</a>

<!-- <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script> -->
<!-- axios ë¼ì´ë¸ŒëŸ¬ë¦¬ -->

<script>

    // axios.get('URL').then((r)=> { console.l0g(r)

    // })

//     // console.log('<%= ê¸€ëª©ë¡[0].id %>')
//     document.querySelectorAll('.delete')[0]
//     .addEventListener('click', function(e){
//         fetch('/delete?docid=' + e.target.dataset.id, {
//             // _id ë¥¼ ì¿¼ë¦¬ìŠ¤íŠ¸ë§ìœ¼ë¡œ ë³´ë‚´ë©´ 
//                     // ajaxëŠ” ìƒˆë¡œê³ ì¹¨ì´ ì—†ë‹¤
//             method : 'DELETE',
//             // headers : {'Content-Type':'application/json'},
//             // body : JSON.stringify({a:1})
//         })
//         .then((r)=>r.text())
//         .then((r)=>{
//             e.target.parentElement.parentElement.style.display = 'none'
//         })
// // - headers ëŠ” ë¶€ê°€ì •ë³´ ê¸°ì…ë€ì¸ë° ì €ë ‡ê²Œ ì‘ì„±í•´ì•¼ array, object ë°ì´í„°ë¥¼ ì„œë²„ë¡œ ì˜ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
// // - body ì•ˆì—ëŠ” ì„œë²„ë¡œ ì „ì†¡í•  array, object ë°ì´í„°ë¥¼ ì§‘ì–´ë„£ìœ¼ë©´ ë©ë‹ˆë‹¤. ê·¼ë° array, object ë¥¼ ê·¸ëƒ¥ ë„£ìœ¼ë©´ ê¹¨ì§€ê¸° ë•Œë¬¸ì— JSON.stringify() ë¥¼ ì¨ì„œ ë¬¸ìí˜•íƒœë¡œ (JSONí˜•íƒœë¡œ) ë°”ê¿”ì„œ ì „ì†¡
//     })

    // fetch('/URL')
    // .then((r)=>{
    // if(r.status == 200) {
    //     return r.json()
    // } else {
    //     //ì„œë²„ê°€ ì—ëŸ¬ì½”ë“œì „ì†¡ì‹œ ì‹¤í–‰í• ì½”ë“œ
    //     alert('ì—ëŸ¬ë‚¨')
    // }
    // })
    // .then((result)=>{ 
    // //ì„±ê³µì‹œ ì‹¤í–‰í• ì½”ë“œ
    // }).catch((error)=>{
    // //ì¸í„°ë„·ë¬¸ì œ ë“±ìœ¼ë¡œ ì‹¤íŒ¨ì‹œ ì‹¤í–‰í• ì½”ë“œ
    // console.log(error)
    // })
    // AJAX ì—ëŸ¬ì²˜ë¦¬ 

    for (let i =0; i < '<%= ê¸€ëª©ë¡.length %>'; i++){
        document.querySelectorAll('.delete')[i]
            .addEventListener('click', function(e){
                fetch('/delete?docid=' + e.target.dataset.id, {
                    // _id ë¥¼ ì¿¼ë¦¬ìŠ¤íŠ¸ë§ìœ¼ë¡œ ë³´ë‚´ë©´ 
                            // ajaxëŠ” ìƒˆë¡œê³ ì¹¨ì´ ì—†ë‹¤
                    method : 'DELETE',
                    // headers : {'Content-Type':'application/json'},
                    // body : JSON.stringify({a:1})
                })
                .then((r)=>r.text())
                .then((r)=>{
                    e.target.parentElement.parentElement.style.display = 'none'
                    // ì‚­ì œë²„íŠ¼ ëˆ„ë¥´ë©´ í•´ë‹¹ html ë¶€ëª¨ì˜ ë¶€ëª¨ ìš”ì†Œ ì•ˆë³´ì´ê²Œ
                })
        // - headers ëŠ” ë¶€ê°€ì •ë³´ ê¸°ì…ë€ì¸ë° ì €ë ‡ê²Œ ì‘ì„±í•´ì•¼ array, object ë°ì´í„°ë¥¼ ì„œë²„ë¡œ ì˜ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
        // - body ì•ˆì—ëŠ” ì„œë²„ë¡œ ì „ì†¡í•  array, object ë°ì´í„°ë¥¼ ì§‘ì–´ë„£ìœ¼ë©´ ë©ë‹ˆë‹¤. ê·¼ë° array, object ë¥¼ ê·¸ëƒ¥ ë„£ìœ¼ë©´ ê¹¨ì§€ê¸° ë•Œë¬¸ì— JSON.stringify() ë¥¼ ì¨ì„œ ë¬¸ìí˜•íƒœë¡œ (JSONí˜•íƒœë¡œ) ë°”ê¿”ì„œ ì „ì†¡
            })
    }
    
</script>

</body>
</html>

<!-- ejsíŒŒì¼ htmlê³¼ ë¹„ìŠ·í•œë° ì„œë²„ë°ì´í„°ë¥¼ ì§‘ì–´ë„£ì„ ìˆ˜ ìˆë‹¤ -->